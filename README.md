# Протоколы осмотра - Мобильное приложение

Кросс-платформенное мобильное приложение для создания протоколов осмотра с видео, фото и скриншотами.

## Функциональность

- **Протокол с видео**: Запись видео камерой телефона с сохранением локально и отправкой на API
- **Протокол с фото**: Съемка нескольких фото с сохранением локально и отправкой на API
- **Протокол со скриншотами**: Создание скриншотов через плавающую кнопку с сохранением локально и отправкой на API
- **Список протоколов**: Просмотр всех созданных протоколов с датой и номером
- **Просмотр PDF**: Открытие PDF файлов, полученных от API

## Технологии

- React Native 0.72.6
- React Navigation для навигации
- React Native Vision Camera для записи видео
- React Native Image Picker для съемки фото
- React Native View Shot для создания скриншотов
- React Native FS для работы с файловой системой
- React Native Device Info для получения уникального ID устройства

## Установка и настройка

### Предварительные требования

- Node.js >= 16
- npm или yarn
- Android Studio (для Android разработки)
- Xcode (для iOS разработки, только на macOS)

### Установка зависимостей

```bash
npm install
```

или

```bash
yarn install
```

### Настройка для Android

1. Убедитесь, что у вас установлен Android Studio и настроен Android SDK
2. Создайте эмулятор Android или подключите физическое устройство
3. Включите режим разработчика и USB отладку на физическом устройстве

### Настройка для iOS (только macOS)

1. Установите CocoaPods:
```bash
sudo gem install cocoapods
```

2. Перейдите в папку ios и установите зависимости:
```bash
cd ios
pod install
cd ..
```

## Запуск приложения

### Запуск Metro Bundler

В отдельном терминале запустите:

```bash
npm start
```

или

```bash
yarn start
```

### Запуск на Android

```bash
npm run android
```

или

```bash
yarn android
```

### Запуск на iOS (только macOS)

```bash
npm run ios
```

или

```bash
yarn ios
```

## Тестирование на Android

### Способ 1: Эмулятор Android

1. **Запустите Android Studio**
2. **Откройте AVD Manager** (Android Virtual Device Manager):
   - Через меню: Tools → Device Manager
   - Или через иконку в панели инструментов
3. **Создайте новый эмулятор** (если еще не создан):
   - Нажмите "Create Device"
   - Выберите устройство (например, Pixel 5)
   - Выберите системный образ (рекомендуется API 33 или выше)
   - Завершите создание эмулятора
4. **Запустите эмулятор**:
   - Нажмите на кнопку Play рядом с созданным эмулятором
   - Дождитесь полной загрузки
5. **Запустите приложение**:
   ```bash
   npm run android
   ```
   Приложение автоматически установится и запустится на эмуляторе

### Способ 2: Физическое Android устройство

1. **Включите режим разработчика**:
   - Откройте Настройки → О телефоне
   - Нажмите 7 раз на "Номер сборки"
   - Появится сообщение "Вы стали разработчиком!"

2. **Включите USB отладку**:
   - Откройте Настройки → Для разработчиков
   - Включите "USB отладка"
   - При подключении к компьютеру подтвердите разрешение на отладку

3. **Подключите устройство к компьютеру**:
   - Используйте USB кабель
   - На устройстве подтвердите разрешение на отладку (если появится запрос)

4. **Проверьте подключение**:
   ```bash
   adb devices
   ```
   Должно появиться ваше устройство в списке

5. **Запустите приложение**:
   ```bash
   npm run android
   ```
   Приложение автоматически установится и запустится на устройстве

### Разрешения на Android

При первом запуске приложение запросит следующие разрешения:
- **Камера** - для съемки видео и фото
- **Микрофон** - для записи звука в видео
- **Хранилище** - для сохранения файлов

Разрешите все запрошенные разрешения для корректной работы приложения.

### Тестирование функций

1. **Протокол с видео**:
   - Нажмите "Протокол с видео"
   - Нажмите красную кнопку для начала записи
   - Нажмите кнопку "Стоп" для завершения записи
   - Нажмите "Отправить" для сохранения и отправки

2. **Протокол с фото**:
   - Нажмите "Протокол с фото"
   - Нажимайте "Добавить фото" для съемки нескольких фото
   - Удаляйте фото нажатием на крестик
   - Нажмите "Отправить" для сохранения и отправки

3. **Протокол со скриншотами**:
   - Нажмите "Протокол со скриншотами"
   - Используйте телефон в обычном режиме
   - Нажимайте на плавающую синюю кнопку справа для создания скриншотов
   - Нажмите "Завершить" для сохранения и отправки

4. **Просмотр протоколов**:
   - Нажмите "Список протоколов" на главном экране
   - Выберите протокол для просмотра деталей
   - Нажмите "Открыть PDF" для просмотра PDF файла

## Структура проекта

```
foxermob/
├── android/              # Нативные файлы Android
├── ios/                  # Нативные файлы iOS (если нужен)
├── src/
│   ├── screens/          # Экраны приложения
│   │   ├── MainScreen.js
│   │   ├── VideoProtocolScreen.js
│   │   ├── PhotoProtocolScreen.js
│   │   ├── ScreenshotProtocolScreen.js
│   │   ├── ProtocolsListScreen.js
│   │   └── ProtocolDetailScreen.js
│   └── services/         # Сервисы
│       ├── ApiService.js
│       ├── DeviceService.js
│       ├── StorageService.js
│       └── ProtocolStorage.js
├── App.js                # Главный компонент
├── index.js              # Точка входа
└── package.json          # Зависимости
```

## API интеграция

В файле `src/services/ApiService.js` находится моковая реализация API. Для подключения реального API:

1. Замените `API_BASE_URL` на адрес вашего сервера
2. Реализуйте реальные функции загрузки файлов
3. Обновите обработку ответов от сервера

## Отладка

### Просмотр логов Android

```bash
adb logcat *:S ReactNative:V ReactNativeJS:V
```

### Очистка кэша

```bash
npm start -- --reset-cache
```

### Пересборка Android

```bash
cd android
./gradlew clean
cd ..
npm run android
```

## Известные ограничения

- API интеграция является моковой - требуется подключение реального API
- PDF файлы пока не сохраняются локально (требуется реализация сохранения из base64)
- Для скриншотов используется `react-native-view-shot`, который может иметь ограничения на некоторых устройствах

## Лицензия

MIT

